import {Component, Input, OnInit} from '@angular/core';
import {Report} from '../report';
import {ReportService} from '../report.service';
import {ActivatedRoute} from '@angular/router';
import {Location} from '@angular/common';

@Component({
    selector: 'app-report-detail',
    templateUrl: './report-detail.component.html',
    styleUrls: ['./report-detail.component.css']
})
export class ReportDetailComponent implements OnInit {

    @Input() currentReport: Report;

    constructor(private route: ActivatedRoute,
                private reportService: ReportService,
                private location: Location) {
    }

    ngOnInit() {
        const id = +this.route.snapshot.paramMap.get('id');
        this.reportService.getReport(id).subscribe(report => this.addAndSortByImpact(report));
    }

    addAndSortByImpact(report : Report) {
        this.currentReport = report;
        this.currentReport.vulns.sort((n1, n2) => {
            return (<number><unknown>n1.impactLevel - <number><unknown>n2.impactLevel);
        });
    }

    goBack() {
        this.location.back();
    }

}
